{
  "db_name": "PostgreSQL",
  "query": "\nINSERT INTO\n    hauls_matrix (\n        message_id,\n        start_timestamp,\n        stop_timestamp,\n        catch_location_matrix_index,\n        catch_location,\n        matrix_month_bucket,\n        vessel_length_group,\n        fiskeridir_vessel_id,\n        gear_group_id,\n        species_group_id,\n        living_weight,\n        haul_distributor_id\n    )\nSELECT\n    e.message_id,\n    e.start_timestamp,\n    e.stop_timestamp,\n    l.matrix_index,\n    l.catch_location_id,\n    HAULS_MATRIX_MONTH_BUCKET (e.start_timestamp),\n    TO_VESSEL_LENGTH_GROUP (e.vessel_length),\n    e.fiskeridir_vessel_id,\n    e.gear_group_id,\n    c.species_group_id,\n    SUM(c.living_weight) * MIN(u.factor),\n    MIN(u.haul_distributor_id)\nFROM\n    UNNEST(\n        $1::BIGINT[],\n        $2::TIMESTAMPTZ[],\n        $3::TIMESTAMPTZ[],\n        $4::TEXT[],\n        $5::DECIMAL[],\n        $6::INT[]\n    ) u (\n        message_id,\n        start_timestamp,\n        stop_timestamp,\n        catch_location,\n        factor,\n        haul_distributor_id\n    )\n    INNER JOIN ers_dca e ON e.message_id = u.message_id\n    AND e.start_timestamp = u.start_timestamp\n    AND e.stop_timestamp = u.stop_timestamp\n    INNER JOIN ers_dca_catches c ON e.message_id = c.message_id\n    AND e.start_timestamp = c.start_timestamp\n    AND e.stop_timestamp = c.stop_timestamp\n    INNER JOIN catch_locations l ON u.catch_location = l.catch_location_id\nGROUP BY\n    e.message_id,\n    e.start_timestamp,\n    e.stop_timestamp,\n    c.species_group_id,\n    l.catch_location_id\n            ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Int8Array",
        "TimestamptzArray",
        "TimestamptzArray",
        "TextArray",
        "NumericArray",
        "Int4Array"
      ]
    },
    "nullable": []
  },
  "hash": "d684798f88d39e4ae5faf94070310ae1697eaac8f258e0ce0dbe93603ce8ccb4"
}
